---
title: "Bayesian networks in R"
author: "Simon Dirmeier <simon.dirmeier@bsse.ethz.ch>"
date: "17. January 2020"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: monokai
      highlightLanguage: R
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'

---

<style type="text/css">
@import url(https://fonts.googleapis.com/css?family=Raleway:400,300,600);

h1, h2, h3 {
  font-family: 'Raleway';
}

.title-slide, .title-slide h1, .title-slide h3 {
  color: black;
  background-color: white;
  text-shadow: none;
  font-family: 'Raleway';
  text-align: left;
}

.title-slide h1 {
  margin-top: 30%;
}

.remark-slide-content {
    font-size: 30px;
    font-family: 'Raleway';
}

a, a code {
  color: maroon;
}

.left-column {
  width: 45%;
  height: 92%;
  float: left;
  padding-top: 1em;
}
.right-column {
  width: 50%;
  height: 92%;
  float: right;
  padding-top: 1em;
}
</style>

```{r setup, include=FALSE, echo=FALSE, message=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.width=5, fig.height=3, fig.align = "center", message=FALSE, warning = FALSE) 

library(magrittr)
library(ggplot2)
library(ggdag)
library(dagitty)
library(pcalg)
library(bnlearn)

dag <- dagitty::dagitty('dag {
    RAF [pos="2,2"]
    MEK [pos="2,1"]
    PIP3 [pos="1,0"]
    PIP2 [pos="1,1"]
    PLCG [pos="0,2"]

    RAF -> PIP2 <- PLCG
    PIP2 -> PIP3
    RAF -> MEK
}')
```

# Before we start

- We will use `R` for learning Bayesian networks from data.
- If you want to follow the tutorials on your laptop, you need some packages. Install them using:

```{r, eval=FALSE}
install.packages(c("dagitty", "pcalg", "bnlearn"))
```

- If you want to do them at some point later, the `R` tutorials can be found on: bit.ly/bayesian-networks
 (the `R` files).

---

# Bayesian networks

.left-column[

```{r, echo=FALSE, dpi=1200}
ggdag::ggdag(dag) + 
  ggplot2::theme_void()
```
]

.right-column[
A Bayesian network is a probability distribution of a multivariate random variable that factorizes w.r.t. a directed acyclic graph.

$$
P(\cdot)
$$
]

---

# Summary

- Causal inference is hard.
- Some of the problems:
    - general non-identifiability
    - confounders
    - immoralities
    - ...
- If you want to learn something about causality and how to design experiments such that analysis won't fail, consider taking Michael Kaltenbach's course.

