---
title: "Bayesian networks in R"
author: "Simon Dirmeier<br>17. January 2020"
output:
  xaringan::moon_reader:
    lib_dir: libs
    css: ["theme.css"]
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'

---

```{r setup, include=FALSE, echo=FALSE, message=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(fig.width=5, fig.height=3, fig.align = "center", message=FALSE, warning = FALSE) 

library(tidyverse)
library(ggflags)
library(cowplot)
library(emo)
library(xkcd)
library(DiagrammeR)

set.seed(1)
n <- 1000
X <- rnorm(n, 1)
Y <- rnorm(n, 1)
Z <- rpois(n, lambda = 5 * (abs(X + Y)))

collider <- data.frame(X=X, Y=Y, Z=Z)
collider.filtered <- collider %>%
  dplyr::group_by(Z) %>%
  dplyr::mutate(cnt = n()) %>%
  dplyr::ungroup() %>%
  dplyr::filter(cnt > 40)
choc <- readr::read_csv(file.path(here::here(), "chocolate.csv"))
exercise <- readr::read_csv(file.path(here::here(), "exercise_cholesterol.csv"))

n <- 100
n.obs <- 89
s <- matrix(0, n, n)
for (i in seq(n.obs))
{
  for (j in seq(i + 1, n.obs + 1)) 
  {
    if (runif(1) < .035) 
    {
      s[i,j] <- 1
    }
  }
  if (sum(s[i,]) == 0) s[i, sample(seq(i + 1, n.obs + 1), 1)] <- 1
}

dag <- DiagrammeR::from_adj_matrix(s, mode = "directed")
```


class: center, middle

<img src="http://www.thegraphicrecorder.com/wp-content/uploads/2012/01/CorrelationCausationFinal1.jpg" width="1000"/>

---

# Summary

- Causal inference is hard.
- Some of the problems:
    - general non-identifiability
    - confounders
    - immoralities
    - ...
- If you want to learn something about causality and how to design experiments such that analysis won't fail, consider taking Michael Kaltenbach's course.

